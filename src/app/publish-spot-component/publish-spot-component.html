<div class="publish-container">
  <header>
    <button class="back-btn" routerLink="/explore"><</button>
    <h1>Publier un spot</h1>
  </header>

  <!-- déclenche onSubmit() quand on soumet le formulaire -->
  <form [formGroup]="spotForm" (ngSubmit)="onSubmit()">
    <label for="title">Titre</label>
    <!-- formControlName lie l'input au champ 'title' du FormGroup -->
    <input type="text" id="title" formControlName="title" placeholder="Ajouter un titre">

    <label for="description">Description</label>
    <textarea id="description" formControlName="description" placeholder="Ajouter une description..."></textarea>

    <div class="row">
      <div class="col">
        <label>Localisation</label>
        <div class="map-preview">
          <img src="assets/images/map-placeholder.jpg" alt="Carte de localisation">
        </div>
      </div>

      <div class="col">
        <label>Note</label>
        <div class="stars">
          <!-- @for pour créer 5 étoiles -->
          @for (s of [1, 2, 3, 4, 5]; track s) {
            <!-- spotForm.get('note')?.setValue(s) met à jour la valeur de la note -->
            <span [class.active]="spotForm.get('note')?.value >= s"
                  (click)="spotForm.get('note')?.setValue(s)">★</span>
          }
        </div>

        <label for="price">Prix</label>
        <div class="price-input">
          <input type="number" id="price" formControlName="price" placeholder="Entrer un prix">
          <span>€</span>
        </div>
      </div>
    </div>

    <label>Services</label>
    <div class="services-grid">
      <!-- on boucle sur tous les services disponibles -->
      @for (service of allServices; track service.name) {
        <!-- vérifie si le service est sélectionné -->
        <div class="service-item"
             [class.selected]="spotForm.get('services')?.value.includes(service.id)"
             (click)="toggleService(service.id)">

          <img [src]="service.icon" [alt]="service.label">
          <p>{{ service.label }}</p>
        </div>
      } @empty {
        <p>Aucun service disponible.</p>
      }
    </div>

    <!-- [disabled] désactive le bouton si le formulaire n'est pas valide -->
    <button type="submit" [disabled]="spotForm.invalid" class="submit-btn">
      Publier le spot
    </button>
  </form>
</div>
